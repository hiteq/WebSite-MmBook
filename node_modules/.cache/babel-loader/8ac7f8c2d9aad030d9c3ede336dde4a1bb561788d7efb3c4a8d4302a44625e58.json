{"ast":null,"code":"import{useDomEvent}from\"framer-motion\";import{spring}from\"popmotion\";import{mix}from\"@popmotion/popcorn\";import{debounce}from\"lodash\";// Absolute distance a wheel scroll event can travel outside of\n// the defined constraints before we fire a \"snap back\" animation\nconst deltaThreshold=5;// If wheel event fires beyond constraints, multiple the delta by this amount\nconst elasticFactor=0.2;function springTo(value,from,to){if(value.isAnimating())return;value.start(complete=>{const animation=spring({from,to,velocity:value.getVelocity(),stiffness:400,damping:40}).start({update:v=>value.set(v),complete});return()=>animation.stop();});}const debouncedSpringTo=debounce(springTo,100);/**\n * Re-implements wheel scroll for overlflow: hidden elements.\n *\n * Adds Apple Watch crown-style constraints, where the user\n * must continue to input wheel events of a certain delta at a certain\n * speed or the scrollable container will spring back to the nearest\n * constraint.\n *\n * Currently achieves this using event.deltaY and a debounce, which\n * feels pretty good during direct input but it'd be better to increase\n * the deltaY threshold during momentum scroll.\n *\n * TODOs before inclusion in Framer Motion:\n * - Detect momentum scroll and increase delta threshold before spring\n * - Remove padding hack\n * - Handle x-axis\n * - Perhaps handle arrow and space keyboard events?\n *\n * @param ref - Ref of the Element to attach listener to\n * @param y - MotionValue for the scrollable element - might be different to the Element\n * @param constraints - top/bottom scroll constraints in pixels.\n * @param isActive - `true` if this listener should fire.\n */export function useWheelScroll(ref,y,constraints,onWheelCallback,isActive){const onWheel=event=>{event.preventDefault();const currentY=y.get();let newY=currentY-event.deltaY;let startedAnimation=false;const isWithinBounds=constraints&&newY>=constraints.top&&newY<=constraints.bottom;if(constraints&&!isWithinBounds){newY=mix(currentY,newY,elasticFactor);if(newY<constraints.top){if(event.deltaY<=deltaThreshold){springTo(y,newY,constraints.top);startedAnimation=true;}else{debouncedSpringTo(y,newY,constraints.top);}}if(newY>constraints.bottom){if(event.deltaY>=-deltaThreshold){springTo(y,newY,constraints.bottom);startedAnimation=true;}else{debouncedSpringTo(y,newY,constraints.bottom);}}}if(!startedAnimation){y.stop();y.set(newY);}else{debouncedSpringTo.cancel();}onWheelCallback(event);};useDomEvent(ref,\"wheel\",isActive&&onWheel,{passive:false});}","map":{"version":3,"names":["useDomEvent","spring","mix","debounce","deltaThreshold","elasticFactor","springTo","value","from","to","isAnimating","start","complete","animation","velocity","getVelocity","stiffness","damping","update","v","set","stop","debouncedSpringTo","useWheelScroll","ref","y","constraints","onWheelCallback","isActive","onWheel","event","preventDefault","currentY","get","newY","deltaY","startedAnimation","isWithinBounds","top","bottom","cancel","passive"],"sources":["/Users/heetaekwoo/Documents/Github/WebSite-MmBook/src/utils/use-wheel-scroll.js"],"sourcesContent":["import { useDomEvent } from \"framer-motion\";\nimport { spring } from \"popmotion\";\nimport { mix } from \"@popmotion/popcorn\";\nimport { debounce } from \"lodash\";\n// Absolute distance a wheel scroll event can travel outside of\n// the defined constraints before we fire a \"snap back\" animation\nconst deltaThreshold = 5;\n// If wheel event fires beyond constraints, multiple the delta by this amount\nconst elasticFactor = 0.2;\nfunction springTo(value, from, to) {\n  if (value.isAnimating()) return;\n  value.start(complete => {\n    const animation = spring({\n      from,\n      to,\n      velocity: value.getVelocity(),\n      stiffness: 400,\n      damping: 40\n    }).start({\n      update: v => value.set(v),\n      complete\n    });\n    return () => animation.stop();\n  });\n}\nconst debouncedSpringTo = debounce(springTo, 100);\n/**\n * Re-implements wheel scroll for overlflow: hidden elements.\n *\n * Adds Apple Watch crown-style constraints, where the user\n * must continue to input wheel events of a certain delta at a certain\n * speed or the scrollable container will spring back to the nearest\n * constraint.\n *\n * Currently achieves this using event.deltaY and a debounce, which\n * feels pretty good during direct input but it'd be better to increase\n * the deltaY threshold during momentum scroll.\n *\n * TODOs before inclusion in Framer Motion:\n * - Detect momentum scroll and increase delta threshold before spring\n * - Remove padding hack\n * - Handle x-axis\n * - Perhaps handle arrow and space keyboard events?\n *\n * @param ref - Ref of the Element to attach listener to\n * @param y - MotionValue for the scrollable element - might be different to the Element\n * @param constraints - top/bottom scroll constraints in pixels.\n * @param isActive - `true` if this listener should fire.\n */\nexport function useWheelScroll(ref, y, constraints, onWheelCallback, isActive) {\n  const onWheel = event => {\n    event.preventDefault();\n    const currentY = y.get();\n    let newY = currentY - event.deltaY;\n    let startedAnimation = false;\n    const isWithinBounds =\n      constraints && newY >= constraints.top && newY <= constraints.bottom;\n    if (constraints && !isWithinBounds) {\n      newY = mix(currentY, newY, elasticFactor);\n      if (newY < constraints.top) {\n        if (event.deltaY <= deltaThreshold) {\n          springTo(y, newY, constraints.top);\n          startedAnimation = true;\n        } else {\n          debouncedSpringTo(y, newY, constraints.top);\n        }\n      }\n      if (newY > constraints.bottom) {\n        if (event.deltaY >= -deltaThreshold) {\n          springTo(y, newY, constraints.bottom);\n          startedAnimation = true;\n        } else {\n          debouncedSpringTo(y, newY, constraints.bottom);\n        }\n      }\n    }\n    if (!startedAnimation) {\n      y.stop();\n      y.set(newY);\n    } else {\n      debouncedSpringTo.cancel();\n    }\n    onWheelCallback(event);\n  };\n  useDomEvent(ref, \"wheel\", isActive && onWheel, { passive: false });\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}